# Wellness_KP
Work for Biomedical Data Translator

Scripts to clean and analyze ISB's wellness dataset. For more details on the graph read the Multiomics Wellness wiki page: https://github.com/NCATSTranslator/Translator-All/wiki/Wellness-KP

Derivation of knowledge from wellness data
1. We have analyzed the ISB Wellness dataset, which has been phenotyped extensively, affording many types of correlations and connections to be uncovered. Expanding on our original wellness study of 108 individuals [5], this deep phenotyping data set integrates many data types including WGS and/or SNP genotyping, clinical blood tests, salivary cortisol, weight and BMI, blood pressure, health assessments, provider notes, gut microbiome, blood metabolomics, blood proteomics, activity tracking, sleep tracking, and heart rate. The cohort includes 4,879 individuals with at least one blood draw via Arivale. Integrative analysis of this multidimensional data set is already leading to significant novel findings, e.g., on the connection between blood metabolites and the microbiome [6] and how this reflects aging [7]. The data were collected in longitudinal ‘snapshots’ that enable a more detailed analysis of data accrual and stability than a single ‘final’ data set view can.
2. We have created and deployed multiple versions of the Multiomics Wellness KG. We computed correlations among attributes in the chemistries, metabolomics and proteomics tables in the ISB Wellness dataset. These attributes are clinical labs, metabolites, and proteins, respectively. Each attribute can either be a blood analyte or an index computed from one or more analytes. For example, the chemistries table has Albumin, Globulin and also the ratio of the two as three different attributes. The resulting KG includes statistically significant correlations from the inner join of the clinical labs, protein panels and metabolites, thus extending on the original version that included only correlations within each table.
3. We performed a detailed curation of LOINC codes for the analytes that have significant correlations with other analytes for the attributes in the chemistries table, and modified the biolink concepts of a subset of nodes to ClinicalFinding to retain LOINC codes that best preserve the identity of a node.
4. We transformed the resulting set of attributes and correlations into a KG (knowledge graph) and expressed them in the KGX format. This format expresses KGs as two TSV files: one for the nodes with necessary columns for curies (a compressed URI that uniquely identifies a node) and a Biolink model concept; and the other representing edges between these nodes, requiring the curies for the two end nodes, a Biolink concept for the relationship between the two nodes and similarly another relationship concept expressed in some standard ontology. In collaboration with Kevin Xin (Su Lab, Service Provider) we deployed this KG via BioThings API.
5. Based on the analysis of snapshots (described below), we implemented metrics of knowledge confidence by taking into account the p-values of correlations between analytes as observed in former data snapshots. The information is presented in the form of a new column in the edges TSV called ‘weighted p-value’, the weight of the p-value in each snapshot is scaled by the factor of the number of observations in the corresponding snapshot. We will further refine this method by making significantly different snapshots (as assessed via data fingerprint comparisons) contribute more to the confidence in the derived knowledge.
6. We have created the first version of a predictive model by creating a regression model for the analytes that are correlated with the most other analytes. As a result, we have a number of new edges and connections between analytes that are actually not significantly correlated with an analyte but are still a regressor of theirs. We used ridge regression for this purpose, so as to have a reliable prediction model for the number of baseline observations, which are fewer than the number of analytes. For example, the protein CVD3_O00300 (tumor necrosis factor receptor superfamily, member 11b) is not significantly correlated with adiponectin in the Wellness graph, but the regression analysis shows that this protein is one of the most important regressors (predictors) of adiponectin, consistent with the literature [8].
7. The new edges so created have the predicate ‘related_to’ and a relation from the RO ontology that more closely describes the relationship of statistical prediction. Biolink is being updated to create a suitable predicate, possibly called ‘regressor_of’ as a hierarchical descendant of ‘predicts’ - see issue Biolink:731.
8. We incorporated the results of stratification of correlations with additional context information on the individuals and the observations, like sex, age group, ancestry, seasonality, and proclivity to having extreme values for specific analytes.
9. We created a new version of the Wellness graph with recomputed correlations between all analytes with a much higher concept pair count. We integrated results for the gut microbiome represented as molecular activity, in the form of its correlations with blood analytes and each other. There are ~5000 unique kegg orthologs that represent the gut microbiome analytes. We expect these results to be soon deployed by the Service Provider.
10. We computed the interactions between various blood analytes and gut microbiome. For the analytes that were significantly correlated, we modeled them pairwise with other analytes to obtain a predictive relationship. We used generalized linear model, to obtain the interaction term (the coefficient of interaction) and its significance using the model:analyte1 ~analyte2 * analyte3 The interaction term analyte2:analyte3 gives a measure of the change in relationship between analyte1and analyte2(or analyte3) in the presence of analyte3(or analyte2). Representation of such knowledge requires an association between three nodes - a limitation in the current Biolink Model.
For example, among the interactions between metabolites and gut microbiome, one significant interaction found was between 1-methylnicotinamide, pyridoxate and glutamate carboxypeptidase [EC:3.4.17.11]. The interaction between pyridoxate and glutamate carboxypeptidase changes both in direction and magnitude of coefficient of relation between the three analytes:
analyte1:                 1-methylnicotinamide
analyte2:                 pyridoxate
analyte3:                 glutamate carboxypeptidase [EC:3.4.17.11]
Coefficient analyte3:    -2.474
Coefficient analyte2:    -0.028
Coefficient interaction:  1.78
P-value analyte3:         2.65e-05
P-value analyte2:         1.39e-16
P-value interaction:      2.63e-91


We encountered an extension of the ‘interactions’ paradigm when we explored the application of Differential Rank Conservation (DIRAC) [9] to ISB’s wellness data. DIRAC requires two-fold separation within data. It provides quantitative measures of how network rankings differ either among networks for a selected phenotype or among phenotypes for a selected network. While the phenotypic separation can be extracted trivially from the Wellness dataset, for example sex or ethnicity based stratification, the network modules within data are hard to construe. The method is designed to analyze relative regulation of modules that are involved in biologically known processes among phenotypes.
We applied DIRAC to the metabolomics data of ISB’s wellness cohort. We divided the cohort into Males and Females, and identified five network modules to work with: ‘Cofactors and Vitamins’, ‘Carbohydrates’, ‘Nucleotides’, ‘Energy’ and ‘Peptides’. The normalized rank indices of the metabolites that form these modules, among males and females are: 
Network                 Females                  Males
Cofactors and Vitamins  243.8                    200.9
Energy                  33.6                     34.4
Carbohydrate            97.9                     85.8
Nucleotide              150.5                    99.9
Peptide                 544.3                    411.6

These results indicate a biologically significant general trend of tighter regulation in the relative abundance of metabolites in most metabolic networks in females. As the Biolink model is adapted to support knowledge generated by graphs that contain N-ary relationships, we can expand the phenotypes for such analyses to contain rank conservation among network modules of diseases.

